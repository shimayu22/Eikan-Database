{% extends './_base.html' %}
{% block content %}
<hr class="mt-5">
<div class="row h4 text-nowrap">
    <div class="col">年度：{{ teams.year }}年</div>
    <div class="col">期間：{{ teams.get_period_display }}</div>
    <div class="col">地区：{{ teams.get_prefecture_display }}</div>
    <div class="col">方針：{{ teams.get_training_policy_display }}</div>
    <div class="col">ランク：{{ teams.rank|default:"未" }}</div>
    <div class="col">指名：{{ teams.draft_nomination }}人</div>
    <div class="col">戦績：
    {% if game_latest.competition_type > 3 and game_latest.competiton_round == 8 and game_latest.result == 1 %}
    {{ game_latest.get_competition_type_display}}優勝
    {% else %}
    {{ game_latest.get_competition_type_display|default:"なし" }}{{ game_latest.get_competiton_round_display }}
    {% endif %}
    </div>
    
    <div class="col">備考：
        {% if players.remark %}
            {{ players.remark }}
        {% endif %}
    </div>
</div>
<hr class="mb-5">
<h3 class="mt-2">チーム成績</h3>
<table class="table table-bordered table-hover table-sm table-responsive-lg text-nowrap">
    <thead class="thead-light text-center">
        <tr>
            <th>年度:期間:地区</th>
            <th>勝</th>
            <th>負</th>
            <th>分</th>
            <th>得点</th>
            <th>失点</th>
            <th>得失</th>
            <th>ランク</th>
            <th>打率</th>
            <th>OPS</th>
            <th>HR</th>
            <th>防御率</th>
            <th><abbr title="(対戦打者-被安打-与四死球-奪三振-失策)/(対戦打者-被本塁打-与四死球-奪三振)">DER</abbr></th>
            <th>備考</th>
        </tr>
    </thead>
    <tbody class="text-right">
        <tr>
            <th class="text-center">{{ team_total_result.team_id }}</th>
            <td>{{ team_total_result.total_win }}</td>
            <td>{{ team_total_result.total_lose }}</td>
            <td>{{ team_total_result.total_draw }}</td>
            <td>{{ team_total_result.score }}</td>
            <td>{{ team_total_result.run }}</td>
            <td>{{ team_total_result.score_difference }}</td>
            <td>{{ team_total_result.team_id.rank }}</td>
            <td>{{ team_total_result.batting_average }}</td>
            <td>{{ team_total_result.ops }}</td>
            <td>{{ team_total_result.hr }}</td>
            <td>{{ team_total_result.era }}</td>
            <td>{{ team_total_result.der }}</td>
            <td class="text-left">
            {% if team_total_result.team_id.remark %}
                {{ team_total_result.team_id.remark }}    
            {% endif %}
            </td>
        </tr>
    </tbody>
</table>

<hr class="mt-5 mb-5">
<h3 class="mt-2">試合結果</h3>
<table class="table table-bordered table-hover table-sm table-responsive-lg text-nowrap">
    <thead class="thead-light text-center">
        <tr>
            <th>試合</th>
            <th>結果</th>
            <th>スコア</th>
            <th>ランク</th>
        </tr>
    </thead>
    <tbody class="text-right">
        {% for g in games %}
        <tr>
            <td class="text-center"><a href="{% url 'eikan:game_detail' g.pk %}">{{ g.get_competition_type_display }}{{ g.get_competiton_round_display|cut:"練習試合"}}</a></td>
            <td class="text-center">{{ g.get_result_display }}</td>
            <td class="text-center">{{ g.score }} - {{ g.run }}</td>
            <td class="text-center">{{ g.get_rank_display }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr class="mt-5 mb-5">
    <h3 class="mt-2">打者成績</h3>
    {% if fielder_results %}
        <table class="table table-bordered table-hover table-sm table-responsive-lg text-nowrap">
            <thead class="thead-light text-center">
                <tr>
                    <th>Player</th>
                    <th>備考</th>
                    <th><abbr title="出塁率+長打率">OPS</abbr></th>
                    <th><abbr title="長打率：塁打/打数">SLG</abbr></th>
                    <th><abbr title="出塁率：(安打+四死球)/(打数+四死球)※犠飛を除外">OBP</abbr></th>
                    <th><abbr title="打撃得点：0.44*(安打-二塁打-三塁打-本塁打)+0.77*二塁打+1.12*三塁打+1.41*本塁打+0.29*四死球-0.25*(打数-安打)※盗塁を除外">BR</abbr></th>
                    <th><abbr title="加重出塁率：(0.7*四死球+0.9*単打+1.3*二塁打+1.6*三塁打+2.0*本塁打)/(打数+四死球)※犠飛を除外">wOBA</abbr></th>
                    <th><abbr title="(出塁率*1.8+長打率)/4">GPA</abbr></th>
                    <th><abbr title="打率：安打/打数">AVG</abbr></th>
                    <th><abbr title="打数">AB</abbr></th>
                    <th><abbr title="得点">R</abbr></th>
                    <th><abbr title="安打">H</abbr></th>
                    <th><abbr title="二塁打">2B</abbr></th>
                    <th><abbr title="三塁打">3B</abbr></th>
                    <th><abbr title="本塁打">HR</abbr></th>
                    <th><abbr title="打点">RBI</abbr></th>
                    <th><abbr title="三振">SO</abbr></th>
                    <th><abbr title="四死球">BB</abbr></th>
                    <th><abbr title="犠打">SAC</abbr></th>
                    <th><abbr title="盗塁">SB</abbr></th>
                    <th><abbr title="併殺打">GDP</abbr></th>
                    <th><abbr title="エラー">ER</abbr></th>
                    <th><abbr title="塁打">TB</abbr></th>
                    <th><abbr title="1つ三振するまでに得た四死球：四死球/三振">BB/K</abbr></th>
                    <th><abbr title="四死球取得率：四死球/(打数+四死球+犠打)※犠飛を除外">BB%</abbr></th>
                    <th><abbr title="出塁率-打率">IsoD</abbr></th>
                    <th><abbr title="長打率-打率">IsoP</abbr></th>
                    <th><abbr title="(本塁打*盗塁*2)/(本塁打+盗塁)">P-S</abbr></th>
                </tr>
            </thead>
            <tbody class="text-right">
                {% for fr in fielder_results %}
                <tr>
                    <th><a href="{% url 'eikan:player_detail' fr.player_id.pk %}">{{ fr.player_id }}</a></th>
                    <td class="text-left">
                        {% if fr.player_id.is_ob %}
                            【OB】 
                        {% endif %} 
                        {% if fr.player_id.is_active %}
                            【現役】 
                        {% endif %} 
                        {% if fr.player_id.is_genius %}
                            【天才】  
                        {% endif %} 
                        {% if fr.player_id.remark %}
                            {{ fr.player_id.remark }}
                        {% endif %}
                    </td>
                    <td>{{ fr.ops|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.slg|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.obp|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.br|floatformat:"1"|default:"0.0" }}</td>
                    <td>{{ fr.woba|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.gpa|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.batting_average|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.at_bat|default:"0" }}</td>
                    <td>{{ fr.run|default:"0" }}</td>
                    <td>{{ fr.hit|default:"0" }}</td>
                    <td>{{ fr.two_base|default:"0" }}</td>
                    <td>{{ fr.three_base|default:"0" }}</td>
                    <td>{{ fr.home_run|default:"0" }}</td>
                    <td>{{ fr.run_batted_in|default:"0" }}</td>
                    <td>{{ fr.strike_out|default:"0" }}</td>
                    <td>{{ fr.bb_hbp|default:"0" }}</td>
                    <td>{{ fr.sacrifice_bunt|default:"0" }}</td>
                    <td>{{ fr.stolen_base|default:"0" }}</td>
                    <td>{{ fr.grounded_into_double_play|default:"0" }}</td>
                    <td>{{ fr.error|default:"0" }}</td>
                    <td>{{ fr.total_bases|default:"0" }}</td>
                    <td>{{ fr.bbhp_k|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.bbhp_percent|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.isod|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.isop|floatformat:"3"|default:"0.000" }}</td>
                    <td>{{ fr.p_s|floatformat:"3"|default:"0.000" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <hr>
        <h3 class="mt-2">投手成績</h3>
        <table class="table table-bordered table-hover table-sm table-responsive-lg text-nowrap">
            <thead class="thead-light text-center">
                <tr>
                    <th>Player</th>
                    <th>備考</th>
                    <th><abbr title="登板数">G</abbr></th>
                    <th><abbr title="先発数">GS</abbr></th>
                    <th><abbr title="投球回数">PI</abbr></th>
                    <th><abbr title="投球数">NP</abbr></th>
                    <th><abbr title="対戦打者">TBF</abbr></th>
                    <th><abbr title="被安打">H</abbr></th>
                    <th><abbr title="奪三振">SO</abbr></th>
                    <th><abbr title="与四死球">BBHP</abbr></th>
                    <th><abbr title="失点">R</abbr></th>
                    <th><abbr title="自責点">ER</abbr></th>
                    <th><abbr title="暴投">WP</abbr></th>
                    <th><abbr title="被本塁打">HR</abbr></th>
                    <th><abbr title="防御率：(自責点*9*3)/(投球回*3)">ERA</abbr></th>
                    <th><abbr title="失点率：(失点*9*3)/(投球回*3)">URA</abbr></th>
                    <th><abbr title="1イニングあたりに出した走者：(被安打+与四死球)*3/(投球回*3)">WHIP</abbr></th>
                    <th><abbr title="1つ四球を出すまでにいくつ三振を取れるか：奪三振/与四死球">K/BB</abbr></th>
                    <th><abbr title="奪三振率：(奪三振*9*3)/(投球回*3)">K/9</abbr></th>
                    <th><abbr title="打者と対戦し奪三振を取る確率：奪三振/対戦打者">K%</abbr></th>
                    <th><abbr title="与四死球率：(与四死球*9*3)/(投球回*3)">BB/9</abbr></th>
                    <th><abbr title="打者と対戦し四死球を与える確率：四死球/対戦打者">BB%</abbr></th>
                    <th><abbr title="被本塁打率：(被本塁打*9*3)/(投球回*3)">HR/9</abbr></th>
                    <th><abbr title="打者と対戦し本塁打を与える確率：被本塁打/対戦打者">HR%</abbr></th>
                    <th><abbr title="出塁した走者に得点を許さなかった割合：(安打+四死球-失点)/(安打+四死球-1.4*本塁打)">LOB%</abbr></th>
                    <th><abbr title="1イニングあたりの投球数：(球数*3)/(投球回*3)">P/IP</abbr></th>
                </tr>
            </thead>
            <tbody class="text-right">
                {% for pr in pitcher_results %}
                <tr>
                    <th><a href="{% url 'eikan:player_detail' pr.player_id.pk %}">{{ pr.player_id }}</a></th>
                    <td class="text-center">
                        {% if pr.player_id.is_ob %}
                            【OB】  
                        {% endif %} 
                        {% if pr.player_id.is_active %}
                            【現役】  
                        {% endif %} 
                        {% if pr.player_id.is_genius %}
                            【天才】  
                        {% endif %} 
                        {% if pr.player_id.remark %}
                            {{ pr.player_id.remark }}
                        {% endif %}
                    </td>
                    <td>{{ pr.games|default:"0" }}</td>
                    <td>{{ pr.games_started|default:"0" }}</td>
                    <td>{{ pr.innings_pitched|default:"0" }}</td>
                    <td>{{ pr.number_of_pitch|default:"0" }}</td>
                    <td>{{ pr.total_batters_faced|default:"0" }}</td>
                    <td>{{ pr.hit|default:"0" }}</td>
                    <td>{{ pr.strike_out|default:"0" }}</td>
                    <td>{{ pr.bb_hbp|default:"0" }}</td>
                    <td>{{ pr.run|default:"0" }}</td>
                    <td>{{ pr.earned_run|default:"0" }}</td>
                    <td>{{ pr.wild_pitch|default:"0" }}</td>
                    <td>{{ pr.home_run|default:"0" }}</td>
                    <td>{{ pr.era|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.ura|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.whip|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.k_bbhp|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.k_9|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.k_percent|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.bbhp_9|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.p_bbhp_percent|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.hr_9|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.hr_percent|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.lob_percent|floatformat:"2"|default:"0.00" }}</td>
                    <td>{{ pr.p_ip|floatformat:"2"|default:"0.00" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="text-center">
            <h4>(登録データが)ないです</h4>
            <p><a href="{% url 'admin:index' %}">管理画面</a>からデータを登録してください。</p>
        </div>
    {% endif %}
{% endblock %}